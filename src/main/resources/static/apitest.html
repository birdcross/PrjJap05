<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
  <h2>Articles API tester</h2>
  <fieldset>
  <label>아이디</label>
  <input type="number" id="id" value="1" /> <br> 
  <label>제목</label>
  <input type="text"   id="title"  /> <br> 
  <label>내용</label>
  <textarea id="content" rows="3"></textarea><br> 
  </fieldset>
  <div id="output"></div>
  <ul>
    <li><a id="get" href="/api/articles">Article 목록 조회(get)</a></li>
    <li><a id="getOne" href="/api/articles">한개의 Article 조회(get)</a></li>
    <li><a id="post" href="/api/articles">새글추가(post)</a></li>
    <li><a id="patch" href="/api/articles">글수정(patch)</a></li>
    <li><a id="delete" href="/api/articles">글삭제(Delete)</a></li>
  </ul>
  
  <script>
    const outputEl = document.querySelector('#output')
    const aElList  = document.querySelectorAll('a')
    aElList.forEach( (aEl, i) => {
	    aEl.onclick = ( e ) => {
            e.preventDefault(); // 기존 a tag 기능을 무력화
			//alert(aEl.id);
            
            switch( aEl.id  ) {
            case "get":
        	    fetch(aEl.href)  // == fetch(aEl.href, { method:'GET'})
	             .then( response => response.json() )
	             .then( json     => {
	                 console.dir(json)
	                 outputEl.innerHTML = JSON.stringify( json );
	             } )
	             .catch( error   => console.dir(error));
	            break;            
            case "getOne":
                const numId = document.querySelector('#id').value; 
	            fetch(aEl.href + "/" + numId )
	             .then( response => response.json() )
	             .then( json     => {
	                 console.dir(json)
	                 outputEl.innerHTML = JSON.stringify( json );
	             } )
	             .catch( error   => console.dir(error));
	            break;
            case "post":            	
                //let numId = document.querySelector('#id').value;
                let id = document.querySelector('#id').value
                let title = document.querySelector('#title').value
                let content = document.querySelector('#content').value
                let params = {
                	method : "POST",
                	headers : {
                		"Accept" : "application/json",
                		"content-Type" : "application/json",
                		"Access-contorl-Origin" : "*" // CORS 정책을 피한다.
                	},
                	body : JSON.stringify({
                		id : id,
                		title : title,
                		content : content,
                	}),
                }
                
	            //fetch(aEl.href, new URLSearchParams(params))
	            fetch(aEl.href, params)
	             .then( response => response.json() )
	             .then( json     => {
	                 console.dir(json)
	                 outputEl.innerHTML = JSON.stringify( json );
	             } )
	             .catch( error   => console.dir(error));
	            break;
            }
            
	    }
    })
    
  
  </script>
</body>





</html>